---
import { getCollection } from 'astro:content';
import type { APIRoute } from 'astro';

export const prerender = true;

export const GET: APIRoute = async () => {
    const cocktails = await getCollection('cocktails');

    const data = cocktails.map(({ id, data }) => ({
        id,
        title: data.title,
        description: data.description,
        spirits: data.spirits ?? (data.spirit ? [data.spirit] : []),
        styles: data.styles ?? [],
        glassware: data.glassware ?? null,
        method: data.method ?? null,
        image: data.image ?? null,
        rating: data.rating ?? null,
        source: data.source ?? null,
    }));

    return new Response(JSON.stringify(data, null, 2), {
        headers: {
            'Content-Type': 'application/json',
        },
    });
};
